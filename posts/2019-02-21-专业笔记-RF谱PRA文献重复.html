<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-04-16 Sat 21:09 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RF谱PRA文献重复</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">RF谱PRA文献重复</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org0c348aa">1. Model 部分</a></li>
<li><a href="#org621046f">2. Sum rules 部分</a>
<ul>
<li><a href="#org8bd7d25">2.1. 假设</a></li>
<li><a href="#orgce2d753">2.2. Transition rate form 3 to 2</a></li>
</ul>
</li>
<li><a href="#org91c1b9d">3. 零温公式推导</a></li>
<li><a href="#org66b54a1">4. 零温数值</a>
<ul>
<li><a href="#orgff9f898">4.1. 化简公式</a></li>
<li><a href="#orgb5e262e">4.2. 无量纲化</a></li>
<li><a href="#org2ef8b90">4.3. 数值处理</a></li>
<li><a href="#org8ef5f6c">4.4. 结果</a>
<ul>
<li><a href="#org0080355">4.4.1. code</a></li>
<li><a href="#orga0b102d">4.4.2. fig</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0b35d1c">5. 零温解析</a>
<ul>
<li><a href="#orgffb857d">5.1. 推导回顾</a></li>
<li><a href="#orgb368a7b">5.2. 解析计算</a></li>
<li><a href="#org482dfe7">5.3. 根据根的情况讨论积分结果</a></li>
<li><a href="#org873b80d">5.4. 代回原式</a></li>
<li><a href="#org45f7a0a">5.5. 积分和结果</a>
<ul>
<li><a href="#orgaeb7821">5.5.1. code</a></li>
</ul>
</li>
<li><a href="#org3db772e">5.6. fig</a></li>
</ul>
</li>
<li><a href="#org659deef">6. 有限温公式推导</a></li>
<li><a href="#orgaa2b689">7. 有限温及零温的最终重复结果</a>
<ul>
<li><a href="#orgf3026c8">7.1. code</a></li>
<li><a href="#orgf362d71">7.2. 结果</a></li>
</ul>
</li>
<li><a href="#org114bf36">8. Supplementary</a></li>
<li><a href="#org646a779">9. 参考文献</a></li>
</ul>
</div>
</div>
<!-- toc -->
<!-- more -->

<div id="outline-container-org0c348aa" class="outline-2">
<h2 id="org0c348aa"><span class="section-number-2">1.</span> Model 部分</h2>
<div class="outline-text-2" id="text-1">
<p>
Hamiltonian 为
</p>
\begin{align*}
  H =& \sum_{k,\sigma}\varepsilon_{k,\sigma} a_{k,\sigma}^{\dagger} a_{k,\sigma}
  + \sum_k (\varepsilon_{k,b}+\delta)b_k^{\dagger}b_k  \\
  & + \frac{\lambda}{\sqrt{\Omega}} \sum_{p,q}(b_{p+q}^{\dagger}a_{p,1}a_{q,2}+\mathrm{H.c.})
\end{align*}
<p>
前两项是原子和分子态的能量, 最后一项是态 1, 2 和分子态之间的耦合项. 其中
</p>
\begin{align*}
  \varepsilon_{k,\sigma} =& \frac{\hbar^2 k^2}{2m} - \mu_{\sigma} \\
  \varepsilon_{k,b} =& \frac{\hbar^2 k^2}{4m} - \mu_1 -\mu_2 \\
  \mu_1 =& \mu_3 = \mu ,\quad \mu_2 =0
\end{align*}
<p>
将耦合部分简记为
</p>
\begin{align*}
  \Lambda = \sum_{p,q}(b_{p+q}^{\dagger}a_{p,1}a_{q,2}+\mathrm{H.c.})
\end{align*}

<p>
微扰为
</p>
\begin{align*}
  V = \sum_k(a_{k,2}^{\dagger}a_{k,3} e^{-\mathrm{i} \omega't}+a_{k,3}^{\dagger}a_{k,2}e^{\mathrm{i}\omega't})
\end{align*}
</div>
</div>

<div id="outline-container-org621046f" class="outline-2">
<h2 id="org621046f"><span class="section-number-2">2.</span> Sum rules 部分</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org8bd7d25" class="outline-3">
<h3 id="org8bd7d25"><span class="section-number-3">2.1.</span> 假设</h3>
<div class="outline-text-3" id="text-2-1">
<p>
假设系统的基态为 1 和 3 态的费米海
</p>
\begin{align*}
  |GS\rangle = |F \rangle = \prod_{k< k_F}  a_{k,1}^{\dagger} a_{k,3}^{\dagger} |0\rangle
\end{align*}
</div>
</div>

<div id="outline-container-orgce2d753" class="outline-3">
<h3 id="orgce2d753"><span class="section-number-3">2.2.</span> Transition rate form 3 to 2</h3>
<div class="outline-text-3" id="text-2-2">
\begin{align*}
  I(\omega) =& 2\pi \sum_f |\langle GS |V |f \rangle|^2 \delta(\omega+\mu -E_f +E_0) \\
            =& 2 \sum_f |\langle GS |V |f \rangle|^2 \mathrm{Im}\frac{1}{\omega +\mu -E_f +E_0 -\mathrm{i}0^{ +}} \\
            \propto &\mathrm{Im} \sum_f \langle GS |V \frac{1}{\omega +\mu -E_f +E_0 -\mathrm{i}0^{ +}} |f \rangle\langle f| V^{\dagger} |GS\rangle  \\
            =& \mathrm{Im}  \langle GS |V \frac{1}{\omega +\mu -H +E_0 -\mathrm{i}0^{ +}}  V^{\dagger} |GS\rangle  \\
            =& \mathrm{Im}  \langle GS |V \frac{1}{\omega - \bar{H}} V^{\dagger} |GS\rangle
\end{align*}
<p>
其中
</p>
\begin{align*}
  \bar{H} = H -E_0 -\mu
\end{align*}
<p>
第二个等号用到了 Dirac Identity
</p>
\begin{align*}
  \frac{1}{x - x_0 \pm \mathrm{i}0^+} = \mathcal{P}\frac{1}{x-x_0} \mp \mathrm{i}\pi\delta(x-x_0)
\end{align*}
</div>
</div>
</div>

<div id="outline-container-org91c1b9d" class="outline-2">
<h2 id="org91c1b9d"><span class="section-number-2">3.</span> 零温公式推导</h2>
<div class="outline-text-2" id="text-3">
<p>
考虑中间态 \(|n\rangle\) 有两种
</p>
\begin{align*}
  |q \rangle =& a_{q,2}^{\dagger} a_{q,3}| F\rangle \quad(q< k_F)\\
  |p,q \rangle =& b_{p+q}^{\dagger} a_{p,1} a_{q_3}|F \rangle \quad(p,q< k_F)
\end{align*}
<p>
耦合作用到中间态上的结果为
</p>
\begin{align*}
  \Lambda |q \rangle =&  \sum_p |p,q\rangle \\
  \Lambda |p,q\rangle =& |q \rangle
\end{align*}
<p>
作用是在两种中间态之间切换,
则 \(\bar{H}\) 在空间中的矩阵元为
</p>
\begin{align*}
  \langle q |\bar{H} |q \rangle =& \varepsilon_{q,2} -\varepsilon_{q,3} - \mu = 0 \\
  \langle p,q|\bar{H} |p,q \rangle =& \delta + \varepsilon_{p+q,b} - \varepsilon_{p,1}-\varepsilon_{q,3}-\mu \\
  \langle q| \bar{H}|p,q\rangle  =& \langle p,q |\bar{H} | q\rangle = \lambda/\sqrt{\Omega}
\end{align*}
<p>
Transition rate form 3 to 2 在上述空间中为
</p>
\begin{align*}
  I(\omega) \propto \mathrm{Im}\sum_{n,n'} \langle GS| V | n \rangle \langle n| \frac{1}{\omega-\bar{H}} | n'\rangle \langle n' V^{\dagger}|GS\rangle
\end{align*}
<p>
将耦合 \(\lambda/\sqrt{\Omega}\Lambda\) 看作小量,即 \(\bar{H}= \bar{H_0}+\lambda/\sqrt{\Omega}\Lambda\) , 可做如下展开
</p>
\begin{align*}
  \frac{1}{\omega-\bar{H}} &=\frac{1}{\omega - \bar{H_0}-\lambda/\sqrt{\Omega}\Lambda}\\
  =& \frac{1}{\omega - \bar{H_0}}\cdot \left( \frac{1}{1- \frac{\lambda}{\sqrt{\Omega}}\frac{1}{\omega-\bar{H_0}}\Lambda} \right) \\
  =& \frac{1}{\omega - \bar{H_0}}\cdot \sum_m \left( \frac{\lambda}{\sqrt{\Omega}}\frac{1}{\omega-\bar{H_0}}\Lambda \right)^m \\
\end{align*}
<p>
而且将微扰 \(V\) 的表达式代入有
</p>
\begin{align*}
  \langle GS| V |n\rangle = \sum_q e^{\mathrm{i}\omega't}\delta_{n,q}\\
  \langle n'| V |GS\rangle = \sum_{q'} e^{-\mathrm{i}\omega't}\delta_{n',q'}\\
\end{align*}
<p>
所以
</p>
\begin{align*}
  I(\omega) \propto& \mathrm{Im}\sum_{q,q'} \langle q| \frac{1}{\omega-\bar{H}} | q'\rangle \\
  =&\mathrm{Im}\sum_{q,q'} \langle q|\frac{1}{\omega - \bar{H_0}}\cdot \sum_m \left( \frac{\lambda}{\sqrt{\Omega}}\frac{1}{\omega-\bar{H_0}}\Lambda \right)^m | q'\rangle \\
\end{align*}
<p>
由前面得出的耦合 \(\Lambda\) 作用在中间态上的结果可知, 耦合作用奇数次会由于正交性使结果为 \(0\) ( \(\bar{H_0}\) 为本征态), 所以 \(m\) 只能取偶数.
而且不同的 \(|q\rangle\) 也是正交的, 所以
</p>
\begin{align*}
  I(\omega) \propto& \mathrm{Im}\sum_q \langle q|\frac{1}{\omega - \bar{H_0}}\cdot \sum_m \left( \frac{\lambda}{\sqrt{\Omega}}\frac{1}{\omega-\bar{H_0}}\Lambda \right)^{2m} | q\rangle \\
                 =& \mathrm{Im}\sum_q \langle q|\frac{1}{\omega - \bar{H_0}}\cdot \sum_m \left( \frac{\lambda^2}{\Omega}\frac{1}{\omega-\bar{H_0}}\Lambda\frac{1}{\omega-\bar{H_0}}\Lambda \right)^m | q\rangle \\
                 =& \mathrm{Im}\sum_q \langle q|\frac{1}{\omega - \bar{H_0}}\cdot \frac{1}{1-  \frac{\lambda^2}{\Omega}\frac{1}{\omega-\bar{H_0}}\Lambda\frac{1}{\omega-\bar{H_0}}\Lambda } | q\rangle \\
                 =& \mathrm{Im}\sum_q \langle q|\frac{1}{\frac{1}{\omega - \bar{H_0}}-  \frac{\lambda^2}{\Omega}\Lambda\frac{1}{\omega-\bar{H_0}}\Lambda } | q\rangle \\
                 =& \mathrm{Im}\sum_{q< q_F}\frac{1}{\omega+ \mu +\varepsilon_{q,3}-\varepsilon_{q,2}-\lambda^2 \theta(q,\omega)}
\end{align*}
<p>
其中
</p>
\begin{align*}
  \theta(q,\omega) = \frac{1}{\Omega} \sum_{p< k_F} \frac{1}{\omega+ \mu  + \varepsilon_{q,3}+\varepsilon_{p,1} - \varepsilon_{p+q,b}-\delta}
\end{align*}
</div>
</div>

<div id="outline-container-org66b54a1" class="outline-2">
<h2 id="org66b54a1"><span class="section-number-2">4.</span> 零温数值</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgff9f898" class="outline-3">
<h3 id="orgff9f898"><span class="section-number-3">4.1.</span> 化简公式</h3>
<div class="outline-text-3" id="text-4-1">
\begin{align*}
  \mu + \varepsilon_{q,3} -\varepsilon_{q,2} = 0
\end{align*}
<p>
所以
</p>
\begin{align*}
  I(\omega) \propto & \mathrm{Im} \sum_{q< q_{F}} \frac{1}{\omega -\lambda^2 \theta(q,\omega)} \\
  =& \sum_{q< k_F} \frac{\lambda^2\mathrm{Im}\theta(q,\omega)}{\left[
  \omega - \lambda^2 \mathrm{Re}\theta(q,\omega) \right]^2
  + \left[ \lambda^2 \mathrm{Im}\theta(q,\omega) \right]^2}
\end{align*}

<p>
而
</p>
\begin{align*}
  \theta(q,\omega) =& \frac{1}{\Omega}\sum_{p< k_F} \frac{1}{\omega + \frac{\hbar^2}{4m}\left(
   p-q\right)^2-\delta}
\end{align*}
</div>
</div>

<div id="outline-container-orgb5e262e" class="outline-3">
<h3 id="orgb5e262e"><span class="section-number-3">4.2.</span> 无量纲化</h3>
<div class="outline-text-3" id="text-4-2">
<p>
对以下量进行无量纲化:
</p>
\begin{align*}
  \tilde{\omega} = \frac{\omega}{\varepsilon_F} ;\quad
  \tilde{\delta} = \frac{\delta}{\varepsilon_F} ;\quad
  \tilde{p} = \frac{p}{k_F} ;\quad \\
  \tilde{q} = \frac{q}{k_F}; \quad
  \tilde{\lambda}^2 = \frac{\lambda^2}{\Omega \varepsilon_F^2}
\end{align*}

<p>
原式就变为
</p>
\begin{align*}
  \theta(\tilde{q},\tilde{\omega}) =& \frac{1}{\Omega \varepsilon_F} \sum_{\tilde{p}< 1}
  \frac{1}{\tilde{\omega} + \frac{1}{2}(\tilde{p}-\tilde{q})^2 -\tilde{\delta} } \\
  =&\frac{1}{\Omega\varepsilon_F}(B+ \mathrm{i}A)
\end{align*}
<p>
其中
</p>
\begin{align*}
  A =& \pi \sum_{\tilde{p}< 1}  \delta\left( \tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 \right) \\
  B =& \sum_{\tilde{p} < 1} \mathcal{P}\frac{1}{\tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 }
\end{align*}
<p>
Transition rate 就记为:
</p>
\begin{align*}
  \varepsilon_F I(\tilde{\omega}) =\sum_{\tilde{q}< 1} \frac{ \tilde{\lambda}^2A}{\left(
  \tilde{\omega} -\tilde{\lambda}^2 B\right)^2+\tilde{\lambda}^4 A^2}
\end{align*}
</div>
</div>

<div id="outline-container-org2ef8b90" class="outline-3">
<h3 id="org2ef8b90"><span class="section-number-3">4.3.</span> 数值处理</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Dirac Delta 函数和主值分别用其极限形式:
</p>
\begin{align*}
  \delta(x) =& \frac{1}{\pi} \lim_{b\to 0}\frac{b}{b^2+x^2} \\
  \mathcal{P}\frac{1}{x} =& \lim_{b\to 0}\frac{x}{b^2+x^2}
\end{align*}
<p>
计算中 \(b=0.0001\) .
</p>

<p>
求和近似为从 \(0\) 到 \(1\) 的积分.
</p>

<p>
数值取值为
</p>
\begin{align*}
  \tilde{\lambda} = 1
\end{align*}
</div>
</div>

<div id="outline-container-org8ef5f6c" class="outline-3">
<h3 id="org8ef5f6c"><span class="section-number-3">4.4.</span> 结果</h3>
<div class="outline-text-3" id="text-4-4">
</div>
<div id="outline-container-org0080355" class="outline-4">
<h4 id="org0080355"><span class="section-number-4">4.4.1.</span> code</h4>
<div class="outline-text-4" id="text-4-4-1">
<div class="org-src-container">
<pre class="src src-python">
import numpy as np
from matplotlib import pyplot as plt
from scipy import integrate

# 定义变量
l = 1 # lambd_tilde

#画图的精度
N = 1000

# 定义delta函数
def delta(x):
    b = .0001
    f = b/(b**2 + x**2)/np.pi
    return f
# 定义主值函数
def pv(x):
    b = 0.0001
    f = x/(b*2 + x**2)
    return f


# 定义最终想要得到的函数
def I(o,d):

    def I(q):#定义没有积分的结果

	def A(q):#定义theta的虚部
	    def A(p):
		x = o + (p-q)**2/2 - d
		A =np.pi * delta(x)
		return A
	    (fres,err) = integrate.quad(A,0,1)
	    return fres

	def B(q):#定义theta的实部
	    def B(p):
		x = o + (p-q)**2/2 - d
		B = pv(x)
		return B
	    (fres,err) = integrate.quad(B,0,1)
	    return fres

	I = l**2*A(q) / ( (o-l**2*B(q))**2 + l**4*A(q)**2 )
	return I

    (fres,err) = integrate.quad(I,0,1)#对其积分,即得到最终结果
    return(fres)



#画图的横坐标omega从-2取到2
omega = np.linspace(-2,2,N)

C = 33 # 画C根线
#求出想要的函数在横坐标取值区间内的结果
I_omega = np.linspace(0,0,N)

for j in range (C):
    d = j-(C-1)/2
    d = d/2 #间距是分母分之一
    for i in range(N):
	I_omega[i-1] = I(omega[i-1],d)
	print(d)
	print(i-1)
    plt.plot(omega,I_omega+100*j, label='d= %.2f' %(d) , color='gray')

#plt.legend()

plt.show()


</pre>
</div>
</div>
</div>

<div id="outline-container-orga0b102d" class="outline-4">
<h4 id="orga0b102d"><span class="section-number-4">4.4.2.</span> fig</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>
结果如图
</p>

<p>
<img src="./2019-02-21-专业笔记-RF谱RPA文献重复/fig4a.jpeg" alt="fig4a.jpeg" />
图中从上到下, \(\tilde{\delta}\) 在区间 \([8,-8]\) 每间隔 \(0.5\) 取一个值.
</p>

<p>
上图的峰一些尖. 如果 Dirac delta 函数中的参数 \(b\) 取得更大一些, 图就会平滑一些.
</p>

<p>
下图是 \(b=0.5\) 时的结果. 为了直观,线的间距也由 \(100\) 改为 \(10\) . 
</p>


<div id="orgf19b9a7" class="figure">
<p><img src="./2019-02-21-专业笔记-RF谱RPA文献重复/fig4a_b=.5.jpeg" alt="fig4a_b=.5.jpeg" />
</p>
</div>



<p>
eps矢量图:
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/fig4a.eps">./2019-02-21-专业笔记-RF谱RPA文献重复/fig4a.eps</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org0b35d1c" class="outline-2">
<h2 id="org0b35d1c"><span class="section-number-2">5.</span> 零温解析</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgffb857d" class="outline-3">
<h3 id="orgffb857d"><span class="section-number-3">5.1.</span> 推导回顾</h3>
<div class="outline-text-3" id="text-5-1">
<p>
原公式为:
</p>
\begin{align*}
  I(\omega) \propto
                  \mathrm{Im}\sum_{q< q_F}\frac{1}{\omega+ \mu +\varepsilon_{q,3}-\varepsilon_{q,2}-\lambda^2 \theta(q,\omega)}
\end{align*}
<p>
其中
</p>
\begin{align*}
  \theta(q,\omega) = \frac{1}{\Omega} \sum_{p< k_F} \frac{1}{\omega+ \mu  + \varepsilon_{q,3}+\varepsilon_{p,1} - \varepsilon_{p+q,b}-\delta}
\end{align*}
<p>
进行化简, 首先在这个系统中有如下关系
</p>
\begin{align*}
  \mu + \varepsilon_{q,3} -\varepsilon_{q,2} = 0
\end{align*}
<p>
所以原式可以化为:
</p>
\begin{align*}
  I(\omega) \propto  \sum_{q< k_F} \frac{\lambda^2\mathrm{Im}\theta(q,\omega)}{\left[
  \omega - \lambda^2 \mathrm{Re}\theta(q,\omega) \right]^2
  + \left[ \lambda^2 \mathrm{Im}\theta(q,\omega) \right]^2}
\end{align*}
<p>
其中
</p>
\begin{align*}
  \theta(q,\omega) =& \frac{1}{\Omega}\sum_{p< k_F} \frac{1}{\omega + \frac{\hbar^2}{4m}\left(
   p-q\right)^2-\delta}
\end{align*}


<p>
对以下量进行无量纲化:
</p>
\begin{align*}
  \tilde{\omega} = \frac{\omega}{\varepsilon_F} ;\quad
  \tilde{\delta} = \frac{\delta}{\varepsilon_F} ;\quad
  \tilde{p} = \frac{p}{k_F} ;\quad \\
  \tilde{q} = \frac{q}{k_F}; \quad
  \tilde{\lambda}^2 = \frac{\lambda^2}{\Omega \varepsilon_F^2}
\end{align*}

<p>
原式就变为
</p>
\begin{align}
  \varepsilon_F I(\tilde{\omega}) =\sum_{\tilde{q}< 1} \frac{ \tilde{\lambda}^2A}{\left(
  \tilde{\omega} -\tilde{\lambda}^2 B\right)^2+\tilde{\lambda}^4 A^2}
\end{align}
<p>
其中
</p>
\begin{align}
  A =& \pi \sum_{\tilde{p}< 1}  \delta\left( \tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 \right) \\
  B =& \sum_{\tilde{p} < 1} \mathcal{P}\frac{1}{\tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 }
\end{align}
</div>
</div>

<div id="outline-container-orgb368a7b" class="outline-3">
<h3 id="orgb368a7b"><span class="section-number-3">5.2.</span> 解析计算</h3>
<div class="outline-text-3" id="text-5-2">
<p>
求和化积分
</p>
\begin{align*}
  A \approx& \pi \frac{Vk^3_F}{(2\pi)^3} \int_{|\tilde{p}| < 1}\mathrm{d}^3\tilde{p} \cdot \delta\left( \tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 \right) =\pi \frac{Vk^3_F}{(2\pi)^3} a\\
  B \approx& \frac{Vk^3_F}{(2\pi)^3} \int_{|\tilde{p}| < 1}\mathrm{d}^3\tilde{p} \cdot\mathcal{P}\frac{1}{\tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 } = \frac{Vk^3_F}{(2\pi)^3} b
\end{align*}
<p>
解析的计算积分 \(a\) 和 \(b\)
</p>
\begin{align*}
  a =&2\pi \int_{-1}^{1}\mathrm{d}x \int_0^1\mathrm{d}\tilde{p} \cdot \delta\left( \tilde{\omega}-\tilde{\delta} +
  \frac{\tilde{p}^2}{2} +\frac{\tilde{q}^2}{2} -\tilde{p}\tilde{q}x \right) \tilde{p}^2\\
  b =&2\pi\int_{-1}^{1}\mathrm{d}x \int_0^1\mathrm{d}\tilde{p} \cdot\mathcal{P}\frac{1}{\tilde{\omega}-\tilde{\delta} +
  \frac{\tilde{p}^2}{2} +\frac{\tilde{q}^2}{2} -\tilde{p}\tilde{q}x }\tilde{p}^2
\end{align*}

<p>
积分 \(a\) 是一个对 \(\delta\) 函数在 \([0,1]\) 区间内的积分. 所以要对 \(\delta\) 函数内的
部分分情况讨论.
</p>

<p>
如果 \(\tilde{\omega}-\tilde{\delta} +
  \frac{\tilde{p}^2}{2} +\frac{\tilde{q}^2}{2} -\tilde{p}\tilde{q}x = 0\)
没有根, 那么积分 \(a=0\) . 如果有根, 记两个根为 \(r_1, r_2\) , 那么积分 \(a\) 化为
</p>
\begin{align*}
  a =&2\pi\int_{-1}^{1}\mathrm{d}x \int_0^1\mathrm{d}\tilde{p}  \cdot \delta\left[ (\tilde{p}-r_1)(\tilde{p}-r_2) \right] \tilde{p}^2 \\
    =&2\pi\frac{1}{|r_1-r_2|} \int_{-1}^{1}\mathrm{d}x \int_0^1\mathrm{d}\tilde{p} \cdot \left[ \delta(\tilde{p}-r_1)
    +\delta(\tilde{p}-r_2) \right] \tilde{p}^2
\end{align*}

<p>
积分 \(b\) 是一个对主值的积分,也需要分情况讨论.
</p>

<p>
如果 \(\tilde{\omega}-\tilde{\delta} +\frac{\tilde{p}^2}{2} +\frac{\tilde{q}^2}{2} -\tilde{p}\tilde{q}x =0\)
没有根, 那么它就可以当做普通的积分
</p>
\begin{align*}
    b =&\int_0^1\mathrm{d}\tilde{p} \cdot \frac{1}{\tilde{\omega}-\tilde{\delta} +
  \frac{1}{2}(\tilde{p}-\tilde{q})^2 } \\
      =&\frac{1}{\tilde{\omega}-\tilde{\delta}} \int_0^1 \mathrm{d}\tilde{p} \cdot
        \frac{1}{1+\left( \frac{\tilde{p}- \tilde{q}}{ \sqrt{2(\tilde{\omega} -\tilde{\delta})} } \right)^2} \\
      =&\frac{1}{\tilde{\omega}-\tilde{\delta}} \cdot \left[ \arctan(t)
        \right]_{t==\frac{-\tilde{q}}{ \sqrt{2(\tilde{\omega} -\tilde{\delta})} }}
          ^{t=\frac{1-\tilde{q}}{ \sqrt{2(\tilde{\omega} -\tilde{\delta})} }}
\end{align*}
<p>
如有两个根 \(r_1, r_2\) 那么
</p>
\begin{align*}
    b =&\int_0^1\mathrm{d}\tilde{p} \cdot \mathcal{P} \frac{1}{(\tilde{p}-r_1)(\tilde{p}-r_2)} \\
      =&\frac{1}{r_1-r_2}\int_0^1\mathrm{d}\tilde{p} \cdot\left[ \mathcal{P}
          \frac{1}{\tilde{p}-r_1}-\mathcal{P}\frac{1}{\tilde{p}-r_2}\right]
\end{align*}

<p>
两个根 \(r_1, r_2\) 是否在积分区间 \([0,1]\) 之间也会对积分 \(a, b\) 的结果有影响.
</p>
</div>
</div>

<div id="outline-container-org482dfe7" class="outline-3">
<h3 id="org482dfe7"><span class="section-number-3">5.3.</span> 根据根的情况讨论积分结果</h3>
<div class="outline-text-3" id="text-5-3">
\begin{align}
  \tilde{\omega}-\tilde{\delta} +\frac{1}{2}(\tilde{p}-\tilde{q})^2 = 0
\end{align}
<p>
如果有根, 记 \(r_1 = \tilde{q} + \sqrt{2(\tilde{\delta}-\tilde{\omega})},
r_1 = \tilde{q} + \sqrt{2(\tilde{\delta}-\tilde{\omega})}\) . 当
\(\tilde{p}, \tilde{\omega}\) 取不同的值时, 根的情况如图
</p>


<div id="org669b7f0" class="figure">
<p><img src="./2019-02-21-专业笔记-RF谱RPA文献重复/root.png" alt="root.png" />
</p>
</div>

<p>
no root 时
</p>
\begin{align*}
  a =&0 \\
  b = &\frac{1}{\tilde{\omega}-\tilde{\delta}} \cdot \left[ \arctan(t)
        \right]_{t==\frac{-\tilde{q}}{ \sqrt{2(\tilde{\omega} -\tilde{\delta})a} }}
          ^{t=\frac{1-\tilde{q}}{ \sqrt{2(\tilde{\omega} -\tilde{\delta})} }}
\end{align*}

<p>
\(r_1, r_2 \in [0,1]\) 时
</p>
\begin{align*}
  a =& \frac{1}{ \sqrt{2(\tilde{\delta}-\tilde{\omega})} } \\
  b =& \frac{1}{r_1-r_2} \ln \frac{ (1-r_1)r_2 }{ (1-r_2)r_1 }
\end{align*}

<p>
\(r_1\in [0,1]\) 和 \(r_2 \in [0,1]\) 时
</p>
\begin{align*}
  a =& \frac{1}{2 \sqrt{2(\tilde{\delta}-\tilde{\omega})} } \\
  b =& \frac{1}{r_1-r_2} \ln \frac{ -(1-r_1)r_2 }{ (1-r_2)r_1 }
\end{align*}

<p>
\(r_1, r_2 \notin [0,1]\) 时
</p>
\begin{align*}
  a =&0 \\
  b =& \frac{1}{r_1-r_2} \ln \frac{ (1-r_1)r_2 }{ (1-r_2)r_1 }
\end{align*}
</div>
</div>

<div id="outline-container-org873b80d" class="outline-3">
<h3 id="org873b80d"><span class="section-number-3">5.4.</span> 代回原式</h3>
<div class="outline-text-3" id="text-5-4">
\begin{align*}
  \varepsilon_F I(\tilde{\omega}) =&\sum_{\tilde{q}< 1} \frac{ \tilde{\lambda}^2A}{\left(
  \tilde{\omega} -\tilde{\lambda}^2 B\right)^2+\tilde{\lambda}^4 A^2} \\
    \approx& \int_0^1 \mathrm{d}\tilde{q}\cdot \frac{ \tilde{\lambda}^2 \pi A}{\left(
  \frac{(2\pi)^3}{Vk_F}\tilde{\omega} -\tilde{\lambda}^2 B\right)^2+\tilde{\lambda}^4 \pi^2 A^2}
\end{align*}
</div>
</div>

<div id="outline-container-org45f7a0a" class="outline-3">
<h3 id="org45f7a0a"><span class="section-number-3">5.5.</span> 积分和结果</h3>
<div class="outline-text-3" id="text-5-5">
</div>
<div id="outline-container-orgaeb7821" class="outline-4">
<h4 id="orgaeb7821"><span class="section-number-4">5.5.1.</span> code</h4>
<div class="outline-text-4" id="text-5-5-1">
<div class="org-src-container">
<pre class="src src-python">import numpy as np
from matplotlib import pyplot as plt
from scipy import integrate

l = 1                           # 定义变量

def delta(x):
    b = .01
    f = b/(b**2 + x**2)/np.pi
    return f

def I(o,d):
    def I(q):
	r1 = q + np.sqrt( 2*(d-o) )
	r2 = q - np.sqrt( 2*(d-o) )

	a1 = 0                  # 无根
	b1 = 1/(o-d) * ( \
			 np.arctan( (1-q)/np.sqrt( 2*(o-d) )  ) - \
			 np.arctan( ( -q)/np.sqrt( 2*(o-d) )  ))

	a2 = 1/np.sqrt( 2*(d-o) ) # 根都在积分区间内
	b2 = 1/(r1-r2)*np.log( ( (1-r1)*r2 )/ \
			       ( (1-r2)*r1 ) )

	a3 = .5/np.sqrt( 2*(d-o) ) # 一内一外
	b3 = 1/(r1-r2)*np.log(-( (1-r1)*r2 )/ \
			       ( (1-r2)*r1 ) )

	a4 = 0                   # 都在外
	b4 = b2

	if o&gt;d:
	    A, B = a1, b1
	    case = 1
	elif o&gt;(d-q**2/2) and o&gt;(d-(1-q)**2/2):
	    A, B = a2, b2
	    case = 2
	elif o&gt;(d-q**2/2) or o&gt;(d-(1-q)**2/2):
	    A, B = a3, b3
	    case = 3
	else:
	    A, B = a4, b4
	    case = 4

	if case == 2 or case == 3:
	    I = l**2*A / ( (o-l**2*B)**2 + l**4*A**2 )
	else:
	    I = delta(o - l**2*B)
	return I
    (fres, err) = integrate.quad(I, 0, 1)
    return fres




N = 1000
#画图的横坐标omega从-2取到2
omega = np.linspace(-2,2,N)

C = 33 # 画C根线
#求出想要的函数在横坐标取值区间内的结果
I_omega = np.linspace(0,0,N)

for j in range (C):
    d = j-(C-1)/2
    d = d/2 #间距是分母分之一
    for i in range(N):
	I_omega[i-1] = I(omega[i-1],d)
	print(d)
	print(i-1)
    plt.plot(omega,I_omega+j*10, label='d= %.2f' %(d) , color='gray')


plt.show()

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3db772e" class="outline-3">
<h3 id="org3db772e"><span class="section-number-3">5.6.</span> fig</h3>
</div>
</div>

<div id="outline-container-org659deef" class="outline-2">
<h2 id="org659deef"><span class="section-number-2">6.</span> 有限温公式推导</h2>
<div class="outline-text-2" id="text-6">
<p>
2 粒子的松原函数(有自能修正)
</p>
\begin{align*}
  G_2(k, \mathrm{i} \omega_2) =& \frac{1}{G_2^0(k,\mathrm{i}\omega_2)^{-1} -\lambda^2 \Sigma (k, \mathrm{i}\omega_2)} \\
                         =& \frac{1}{\mathrm{i}\omega_2 - \epsilon_{k,2} -\lambda^2 \Sigma (k, \mathrm{i}\omega_2)}
\end{align*}
<p>
3 粒子的松原函数(无相互作用)
</p>
\begin{align*}
  G_3^0(k,\mathrm{i}\omega_3) = \frac{1}{\mathrm{i}\omega_3 - \epsilon_{k,3}}
\end{align*}
<p>
代入总的松原函数
</p>
\begin{align*}
  R(k , \mathrm{i}\omega_n) =& \frac{1}{\beta}\sum_{\omega_2} G_3(k,\mathrm{i}(\omega_2-\omega_n)) G_2(k,\mathrm{i}\omega_2)\\
   =& \frac{1}{\beta} \sum_{\omega_2} \frac{1}{\mathrm{i}(\omega_2 -\omega_n) - \epsilon_{k,3}}\cdot
     \frac{1}{\mathrm{i}\omega_2 - \epsilon_{k,2} -\lambda^2 \Sigma (k, \mathrm{i}\omega_2)} \\
   =&\frac{1}{\beta} \sum_{\omega_2}\left( \frac{1}{\mathrm{i}(\omega_2 -\omega_n) - \epsilon_{k,3}} +
     \frac{-1}{\mathrm{i}\omega_2 - \epsilon_{k,2} -\lambda^2 \Sigma (k, \mathrm{i}\omega_2)} \right)\cdot
     \frac{1}{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_2)}
\end{align*}
<p>
接下来单独计算第一项
</p>
\begin{align*}
  \frac{1}{\beta} \sum_{\omega_2} \frac{1}{\mathrm{i}(\omega_2 -\omega_n) - \epsilon_{k,3}}\cdot
  \frac{1}{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_2)}
\end{align*}
<p>
利用环路积分计算此项. 积分
</p>
\begin{align*}
  \oint_{R\to\infty}\frac{1}{\mathrm{i}(\omega_2 -\omega_n) - \epsilon_{k,3}}\cdot
  \frac{1}{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_2)}
  \cdot \frac{1}{e^{\mathrm{i}\beta\omega_2} +1}\mathrm{d}\omega_2 = 0
\end{align*}
<p>
积分的留数为:
</p>

<p>
第三项对应的留数
</p>
\begin{align*}
  R_3 =   \frac{1}{\beta} \sum_{\omega_2} \frac{1}{\mathrm{i}(\omega_2 -\omega_n) - \epsilon_{k,3}}\cdot
  \frac{1}{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_2)}
\end{align*}
<p>
其中 \(\omega_2 = (2m+1)\pi/\beta\) . 就是要求的总的松原函数 \(R(k,\mathrm{i}\omega)\) .
</p>

<p>
第一项对应的留数
</p>
\begin{align*}
  R_1 =& \frac{1}{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_n +\epsilon_{k,3})}
  \cdot \frac{1}{e^{\beta(\mathrm{i}\omega_n + \epsilon_{k,3})} +1} \\
      =& \frac{ f(\epsilon_{k,3}) }{\mathrm{i}\omega_n +\epsilon_{k,3}-\epsilon_{k,2}-\lambda^2 \Sigma (k, \mathrm{i}\omega_n +\epsilon_{k,3})}
\end{align*}
</div>
</div>

<div id="outline-container-orgaa2b689" class="outline-2">
<h2 id="orgaa2b689"><span class="section-number-2">7.</span> 有限温及零温的最终重复结果</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgf3026c8" class="outline-3">
<h3 id="orgf3026c8"><span class="section-number-3">7.1.</span> code</h3>
<div class="outline-text-3" id="text-7-1">
<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=0.py">./2019-02-21-专业笔记-RF谱RPA文献重复/T=0.py</a>
</p>

<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.py">./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.py</a>
</p>

<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.py">./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.py</a>
</p>
<div class="org-src-container">
<pre class="src src-python">import numpy as np
from matplotlib import pyplot as plt
from scipy import integrate
from scipy.special import roots_legendre as leg
def gauquad(f,a,b,n = 50):
    '''
    定义 Gaussian quadrature 积分
    函数 f 的积分区间为 [a,b]
    取 n 个 Legendre 的根
    def Gaussian quadrature integration
    integrate function f from a to b
    take n Legendre roots
    '''
    ft = lambda t: f( (b-a)*t/2 +(a+b)/2 ) * (b-a)/2
    x, w = leg(n)
    I = 0
    for i in range(n):
	I = I + w[i]*ft(x[i])
    err = 0
    return I,err
def twovarplt(f,ax,bx,ay,by,Nx=100,Ny=10,gap = 2):
    '''
    两变量画图
    f(x,y): 要绘制的函数
    变量 x 的取值区间为 [ax,bx], 取点的个数为 Nx 个
    变量 y 的取值区间为 [ay,by], 画 Ny 条线, 每条线对应一个 y 值
    线与线之间的间隔为 gap
    two variables plot
    plot function f(x,y)
    x takes Nx points from 'ax' to 'bx'
    each line corresponds a fixd y, y takes Ny points from 'ay' to 'by'
    the gap between lines is 'gap'
    '''
    x = np.linspace(ax,bx,Nx)
    y = np.linspace(ay,by,Ny)
    fx = np.linspace(0,0,Nx)
    for j in range(Ny):
	for i in range(Nx):
	    print('第',j+1,'条线,','第',i+1,'个点,','共',Ny,'条线,','每条线',Nx,'个点.')
	    fx[i] = f(x[i],y[j])
	plt.plot(x,fx+j*gap )
    #    plt.plot(x,x*0+y[j],color=(j/Ny,1-j/Ny,j/Ny))
    plt.xlabel(r'$\tilde{\omega}$')
    plt.ylabel(r'$I(\tilde{\omega})$')
    plt.yticks([])
    plt.savefig('./T = 2.jpeg',writer='imagemagick')
    plt.show()

def f(p,m,T):   # Fermi distribution function
    f = 1/(np.exp((p**2-m)/T)+1)
    return f
def theta(x):   # Heaviside theta function
    if x&gt;=0:
	f = 1
    else:
	f = 0
    return f
def delta(x,b = 1e-2):  # Dirac delta function
    b = 1e-2
    f = b/(b**2 + x**2)/np.pi
    return f

T = 2  # Temperature
m = 1   # Chemical potential mu
up = 10 # Integration cut off of 

def A(o,d,k,p): # the unintegrated Imaginary part of self-energy
    x1 = o-d+p**2/2+k**2/2-p*k
    x2 = o-d+p**2/2+k**2/2+p*k
    if x1&gt;0 or x2&lt;0:
	A = 0
    else:
	A = np.pi*p/k*f(p,m,T)
    return A
def AA(o,d,k):  # the integrated Imaginary part of self-energy
    AA, err = gauquad(lambda p:A(o,d,k,p),0,up)
    return AA
def s(o,d,k,p): # the unintegrated Real part of self-energy
    s = f(p,m,T)*p/k*( np.log( np.abs(o-d + (k+p)**2/2) ) - np.log( np.abs(o-d + (k-p)**2/2) ) )
    return s
def S(o,d,k):   # the integrated Real part of self-energy
    S,err = gauquad(lambda p:s(o,d,k,p),0,up)
    return S

def I(o,d,k):   # the unintegrated spectral function
    aa = AA(o,d,k)
    bb = S(o,d,k)
    if aa == 0:
	I = k**2*f(k,m,T)*delta(o-bb,b=1)
    else:
	I = k**2*f(k,m,T)*aa/((o-bb)**2+aa**2)
    return I
def II(o,d):    # the integrated spectral function
    if d&gt;o:
	II,err = gauquad(lambda k:I(o,d,k),0,up,n = 100)
    else:
	II, err = integrate.quad(lambda k:I(o,d,k),0,up,epsabs=1.49e-2)
    return II

twovarplt(II,-2,2,-8,8,Nx = 1000,Ny=33,gap=3)

#twovarplt(lambda k ,o:S(o,0,k),0,10,0.1,2,Nx = 100,Ny = 25,gap=0)

'''
def A(o,d,k,x):
    g = o-d+k**2/2
    r1 = k*x + np.sqrt( k**2*x**2 -2*g )
    r2 = k*x - np.sqrt( k**2*x**2 -2*g )
    A = theta(-g)*theta(1+2*g-2*k*x)*r1**2*f(r1,m,T)
    A = A+ theta(g)*theta(k*x-np.sqrt(2*g))*theta(x) * ( theta(1+2*g-2*k*x)*r1**2*f(r1,m,T) + r2**2*f(r2,m,T))
    A = A/(r1-r2)
    return A
def AA(o,d,k):
    AA, err = gauquad(lambda x:A(o,d,k,x),-1,1)
    AA = np.nan_to_num(AA)
    AA = np.pi*AA
    return AA
'''
'''
    n = 500
    k = np.linspace(1e-5,up,n)
    for i in range(n):
	dd = np.abs(o - S(o,d,k[i]))
    #    print(dd)
	if dd&lt;1e-1:
	    ko = k[i]
	    break
	else:
	    ko = 0
    II = ko**2*f(ko,m,T)
    return II
'''
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf362d71" class="outline-3">
<h3 id="orgf362d71"><span class="section-number-3">7.2.</span> 结果</h3>
<div class="outline-text-3" id="text-7-2">

<div id="orgd302ff1" class="figure">
<p><img src="./2019-02-21-专业笔记-RF谱RPA文献重复/T=0.png" alt="T=0.png" />
</p>
</div>


<div id="orgb7c3e7d" class="figure">
<p><img src="./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.png" alt="T=1.png" />
</p>
</div>


<div id="org2930423" class="figure">
<p><img src="./2019-02-21-专业笔记-RF谱RPA文献重复/T=2.png" alt="T=2.png" />
</p>
</div>

<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=0.eps">./2019-02-21-专业笔记-RF谱RPA文献重复/T=0.eps</a>
</p>

<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.eps">./2019-02-21-专业笔记-RF谱RPA文献重复/T=1.eps</a>
</p>

<p>
<a href="./2019-02-21-专业笔记-RF谱RPA文献重复/T=2.eps">./2019-02-21-专业笔记-RF谱RPA文献重复/T=2.eps</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org114bf36" class="outline-2">
<h2 id="org114bf36"><span class="section-number-2">8.</span> Supplementary</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-python">
import numpy as np
from matplotlib import pyplot as plt

delta = .5
N = 100
o = np.linspace(-2, 2, N)
q = np.linspace(-2, 2, N)
fig, ax = plt.subplots()
#line = ax.plot(o,q)
#ax3 = fig.add_axes([0.1, 0.1, 0.2, 0.2])

#ax.plot(o,o*0+1)
#ax.plot(o,o*0)
ax.plot(o*0+delta,o, color = 'green')
ax.plot(o*0+delta-.5,o, color = 'gray', linestyle = '--')
ax.plot(delta - q**2/2, q, 'r', label = r'$\~\omega = \~\delta - \frac{\~q^2}{2}$')
ax.plot(delta - (q-1)**2/2, q, color = 'blue', label = r'$\~\omega = \~\delta - \frac{(\~q-1)^2}{2}$')

ax.text(-1.2, .5, r'$r_1,r_2\notin [0,1]$', {'fontsize':20})
ax.text(.05, .95, r'$r_2\in [0,1]$', {'fontsize':20})
ax.text(.07, .05, r'$r_1\in [0,1]$', {'fontsize':20})
ax.text(1, .5, r'no root', {'fontsize':20})

ax.arrow(1, .25, -.55, .25, width = .01)
ax.text(1, .25, r'$r_1,r_2\in [0,1]$', {'fontsize':20})

#ax.set_xlim(0,4*np.pi)
ax.set_xlim(-2,2)
ax.set_ylim(0,1)
ax.set_xticks([-2, delta-.5, delta, 2])
ax.set_yticks([0,1],)
ax.set_xticklabels(['$-2$', '$\~\delta-1/2$', '$\~\delta$', '$2$'],{'fontsize':20})
ax.set_yticklabels([0,1],{'fontsize':20})
ax.set_xlabel('$\~\omega$',{'fontsize':20})
ax.set_ylabel('$\~q$',{'fontsize':20})
ax.legend(fontsize = 20)
plt.show()

</pre>
</div>
</div>
</div>



<div id="outline-container-org646a779" class="outline-2">
<h2 id="org646a779"><span class="section-number-2">9.</span> 参考文献</h2>
<div class="outline-text-2" id="text-9">
<p>
Junjun Xu, Qiang Gu, and Erich J. Mueller Phys. Rev. A 88, 023604 (2013)
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2019-02-21 Thu 00:00</p>
<p class="date">Created: 2022-04-16 Sat 21:09</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
